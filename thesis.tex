\documentclass[ twoside,openright,titlepage,numbers=noenddot,headinclude,
                footinclude=true,cleardoublepage=empty,abstractoff,%
                BCOR=5mm,paper=letter,fontsize=11pt,letterpaper,%
                american,%
                ]{scrreprt}

\usepackage[square,numbers]{natbib}
\usepackage{amsmath}
\usepackage{xspace} % to get the spacing after macros right
\usepackage{mparhack} % get marginpar right
\usepackage{fixltx2e} % fixes some LaTeX stuff
\usepackage[printonlyused,smaller]{acronym}
\usepackage[pdfpagelabels]{hyperref}
\usepackage{graphicx}
\usepackage{tabularx}
    \setlength{\extrarowheight}{3pt} % increase table row height
\usepackage{etoolbox}

% Thesis metadata.
\input{metadata}

\hypersetup{
    colorlinks=false,
    hidelinks,
    linktocpage=true,
    breaklinks=true,
    hypertexnames=true,
    pdftitle={\metadata{title}},
    pdfauthor={\textcopyright\ \metadata{author}, \metadata{school}},
    pdfsubject={},
    pdfkeywords={},
    pdfcreator={pdfLaTeX},
    pdfproducer={LaTeX with hyperref and classicthesis}
}

\usepackage[eulerchapternumbers,listings,%
            pdfspacing,%floatperchapter,%linedheaders,%
            beramono,eulermath,parts]{classicthesis}

% XeTeX fonts.
\usepackage{fontspec}
\setmainfont[
    Ligatures={Common,TeX},
    UprightFont={*-Roman},
    BoldFont={*-Bold},
    ItalicFont={*-Italic},
    BoldItalicFont={*-BoldItalic},
    Extension={.otf},
    Path={crimson/},
]{Crimson}

% Version marker.
% Set "final" option to turn off marker.
\usepackage[time=false]{prelim2e}
\input{revision}
\renewcommand{\PrelimWords}{%
    rev. \Revision%
    }

% I don't know why classicthesis wants this. Something about hyperlinks?
\newcounter{dummy}

\begin{document}
\raggedbottom
%\renewcommand*{\bibname}{new name}
\pagenumbering{roman}
\pagestyle{plain}


% TITLE PAGE
\begin{titlepage}
	% if you want the titlepage to be centered, uncomment and fine-tune the line below (KOMA classes environment)
	\begin{addmargin}[-1cm]{-3cm}
    \begin{center}
        \large
        \hfill
        \vfill
        \begingroup
            \color{Violet}\spacedallcaps{Hardware and Software} \\
            \color{Violet}\spacedallcaps{for Approximate Computing} \\ \bigskip
        \endgroup
        \spacedlowsmallcaps{Adrian Sampson}
        \vfill
        A dissertation \\
        submitted in partial fulfillment of the \\
        requirements for the degree of \\
        \medskip
        \metadata{degree} \\
        \bigskip
        \metadata{school} \\
        \smallskip
        \metadata{year}
        \vfill
        Reading Committee: \\
        \smallskip
        Luis Ceze, Chair \\
        \smallskip
        Dan Grossman, Chair \\
        \smallskip
        Mark Oskin
        \vfill
        Program Authorized to Offer Degree: \\
        \smallskip
        \metadata{department}
    \end{center}
  \end{addmargin}
\end{titlepage}


% COPYRIGHT PAGE
\cleardoublepage
\thispagestyle{empty}
\begin{center}
    \vspace*{20ex}
    \textcopyright\ \metadata{year} \\
    \bigskip
    \metadata{author}
\end{center}


% ABSTRACT
\cleardoublepage
\thispagestyle{empty}
\pdfbookmark[1]{Abstract}{Abstract}

\begin{center}
    \spacedlowsmallcaps{Abstract} \\
    \bigskip
    \spacedallcaps{Hardware and Software} \\
    \spacedallcaps{for Approximate Computing} \\
    \bigskip
    \metadata{author} \\
    \bigskip
    Chairs of the Supervisory Committee: \\
    Associate Professor Luis Ceze \\
    Professor Dan Grossman \\
    \metadata{department} \\
    \bigskip
\end{center}

\input{text/abstract}


% DEDICATION
\cleardoublepage
\thispagestyle{empty}
%\phantomsection
\refstepcounter{dummy}
\pdfbookmark[1]{Dedication}{Dedication}
\vspace*{3cm}
\begin{center}
    \textit{Foo.}
    \\ \medskip
    --- Bar
\end{center}


% CONTENTS
\renewcommand{\contentsname}{Table of Contents}
\pagestyle{scrheadings}
%\phantomsection
\refstepcounter{dummy}
\pdfbookmark[1]{\contentsname}{tableofcontents}
\setcounter{tocdepth}{2} % <-- 2 includes up to subsections in the ToC
\setcounter{secnumdepth}{3} % <-- 3 numbers up to subsubsections
\manualmark
\markboth{\spacedlowsmallcaps{\contentsname}}{\spacedlowsmallcaps{\contentsname}}
\tableofcontents
\automark[section]{chapter}
\renewcommand{\chaptermark}[1]{\markboth{\spacedlowsmallcaps{#1}}{\spacedlowsmallcaps{#1}}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\enspace\spacedlowsmallcaps{#1}}}
\clearpage

\cleardoublepage


% ACKS
\cleardoublepage
\pdfbookmark[1]{Acknowledgments}{acknowledgments}
\chapter*{Acknowledgments}

Acknowledgments go here.~\cite{sommerville:1992}


\pagenumbering{arabic}

% PART 1
\cleardoublepage
\part{Approximate Computing}
\chapter{Introduction}
\label{ch:introduction}
A bunch of text will go here.


% BIB
% work-around to have small caps also here in the headline
\manualmark
\markboth{\spacedlowsmallcaps{\bibname}}{\spacedlowsmallcaps{\bibname}} % work-around to have small caps also
%\phantomsection
\refstepcounter{dummy}
\addtocontents{toc}{\protect\vspace{\beforebibskip}} % to have the bib a bit from the rest in the toc
\addcontentsline{toc}{chapter}{\tocEntry{\bibname}}
\bibliographystyle{plainnat}
\label{app:bibliography}
\bibliography{thesis}


% COLOPHON
\cleardoublepage
\pagestyle{empty}
\vspace*{20ex}
\pdfbookmark[0]{Colophon}{colophon}
\section*{Colophon}
\input{text/colophon}


\end{document}
